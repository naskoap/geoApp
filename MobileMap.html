<!--
 geoApp
 Geolocation map of Sewanee -->
<!DOCTYPE html>
<html>
  <head>
    <title> Sewanee map </title>   
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1 user-scalable=no">
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="css/mobileStyling.css" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true&libraries=places"></script>
    <script src="coords.js"> </script>
    <script src="direct.js"> </script>
    <script src="bootstrap/js/jquery.js"></script>
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <script src="bootstrap/js/bootstrap.js"></script>
    <script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobubble/src/infobubble.js"></script>
    <script src="Pictures.js"></script>
    <script src="walkingTour.js"></script>
    <script type="text/javascript">

var map, infowindow, marker, marker1, posMarker, dMarker, aMarker, positionTimer,infowindowU, infowindowD, infowindowA, tourLine;
var coords = new google.maps.LatLng(35.20438,-85.92016);
var markersArray  = [];
var markersArrayD  = [];
var markersArrayA  = [];
var dormMarkerBox = [];
var academicMBox  = [];
var dormPolygonArray = [];
var infoArrayU = [];
var infoArrayD = [];
var infoArrayA = [];
var storeB, storeZ;
var infoBubble;
var infoBubbleA;
var infoBubbleD;
var contentStringU;
var contentStringA;
var contentStringD;
var infoBubbleArrayU = [];
var infoBubbleArrayA = [];
var infoBubbleArrayD = [];
var acadPolygonArray = [];
var univPolygonArray = [];
var currentLocationArray = [];
var tourLineArray = [];
var tourLineArrayIndoor = [];

function initialize() {

    var mapOptions = {
        center: coords,
        zoom: 17,
        mapTypeId: google.maps.MapTypeId.ROADMAP
};

    map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
  
    var infowindow1 = new google.maps.InfoWindow({
          content: ""
}
  );

            infoBubble = new InfoBubble({
          maxWidth: 100
        });
                infoBubbleA = new InfoBubble({
          maxWidth: 100
        });
                infoBubbleD = new InfoBubble({
          maxWidth: 100
        });
      //Construct markers
    // DORM MARKERS START
            for (var p=0; p < locationNameArrayD.length; p++) {
         contentStringD = '<div>'+
      '<div>'+
      '</div>'+
      '<h1>' + locationNameArrayD[p] + '</h1>'+
      '<div>'+
      '<p>Welcome to ' + locationNameArrayD[p] + '!</p>' +
      '</div>'+
      '</div>';
    infoBubbleArrayD[p] = contentStringD;
    }

      for (var i=0; i <= locationNameArrayD.length; i++) {
      var storeY = infoBubbleArrayD[i];
      var storeW = infoBubbleArrayD[i];
      dMarker = new google.maps.Marker({
      position: dormMarkerarray[i],
      map: map,
      icon: 'markers/yellowMarker.png',
      title: locationNameArrayD[i]
      });
      dormMarkerBox.push(dMarker);
      markersArrayD.push(dMarker);  // -> Attempt to push the marker to an array s
      markersArrayD[i].setMap(null);
      linkInfoBubble(dMarker, map, infoBubbleD, storeY, storeW);
}
            google.maps.event.addListener(dMarker, 'click', function() {
            infoBubbleD.open(map, dMarker);
          
          });
       function linkInfoBubble(dMarker, map, infoBubbleD, description5, description6){ 
       
       google.maps.event.addListener(aMarker, 'click', function() {
       if('click'){infoBubbleD.close();}
       if(infoBubbleD.getMap()){
          infoBubbleD.close();
       }
       if (infoBubbleD.getMap() != null) {
          delete infoBubbleD;
          infoBubbleD = new InfoBubble({
          maxWidth: 300
        });
      }
                  if(infoBubbleD.getMap()){
          infoBubbleD.close();
       }
       infoBubbleD.open(map, dMarker);
       infoBubbleD.addTab('Building', description5);
       infoBubbleD.addTab('Photo', description6);

}
    );
        }
    
    
    
    
    
    
    
    //ACADEMIC MARKERS
    
        for (var p=0; p < locationNameArrayA.length; p++) {
         contentStringA = '<div>'+
      '<div>'+
      '</div>'+
      '<h1>' + locationNameArrayA[p] + '</h1>'+
      '<div>'+
      '<p>Welcome to ' + locationNameArrayA[p] + '!</p>' +
      '</div>'+
      '</div>';
    infoBubbleArrayA[p] = contentStringA;
    }

      for (var i=0; i <= academicArray.length; i++) {
      var storeK = infoBubbleArrayA[i];
      var storeT = infoBubbleArrayA[i];
      aMarker = new google.maps.Marker({
      position: academicArray[i],
      map: map,
      icon: 'markers/blue-dot.png',
      title: locationNameArrayA[i]
      });
      academicMBox.push(aMarker);  // -> Attempt to push the marker to an array s
      academicMBox[i].setMap(null);
      linkInfoBubble(aMarker, map, infoBubbleA, storeK, storeT);
}
            google.maps.event.addListener(aMarker, 'click', function() {
            infoBubbleA.open(map, aMarker);
          
          });
       function linkInfoBubble(aMarker, map, infoBubbleA, description3, description4){ 
       
       google.maps.event.addListener(aMarker, 'click', function() {
       if('click'){infoBubbleA.close();}
       if(infoBubbleA.getMap()){
          infoBubbleA.close();
       }
       if (infoBubbleA.getMap() != null) {
          delete infoBubbleA;
          infoBubbleA = new InfoBubble({
          maxWidth: 300
        });
      }
                  if(infoBubbleA.getMap()){
          infoBubbleA.close();
       }
       infoBubbleA.open(map, aMarker);
       infoBubbleA.addTab('Building', description3);
       infoBubbleA.addTab('Photo', description4);

}
    );
        }
    
    
    
    
    
    
    
    //UNIVERSITY MARKERS
    
    for (var p=0; p < locationArrayU.length; p++) {
         contentString = '<div>'+
      '<div>'+
      '</div>'+
      '<h1>' + locationNameArrayU[p] + '</h1>'+
      '<div>'+
      '<p>Welcome to ' + locationNameArrayU[p] + '!</p>' +
      '</div>'+
      '</div>';
    infoBubbleArrayU[p] = contentString;
    }

      for (var i=0; i < locationArrayU.length; i++) {
      var storeU = infoBubbleArrayU[i];
      var storeP = pictureArrayU[i];
      marker1 = new google.maps.Marker({
      position: locationArrayU[i],
      map: map,
      title: locationNameArrayU[i]
      });
      markersArray.push(marker1);  // -> Attempt to push the marker to an array s
      markersArray[i].setMap(null);
      linkInfoBubble(marker1, map, infoBubble, storeU, storeP);
}
            google.maps.event.addListener(marker, 'click', function() {
            infoBubble.open(map, marker1);
          
          });
       function linkInfoBubble(marker1, map, infoBubble, description1, description2){ 
       google.maps.event.addListener(marker1, 'click', function() {
       google.maps.event.addListener(map, "click", function () { 
       infoBubble.close();
        });
       if('click'){infoBubble.close();}
       if(infoBubble.getMap()){
          infoBubble.close();
       }
       if (infoBubble.getMap() != null) {
          delete InfoBubble;
          infoBubble = new InfoBubble({
          maxWidth: 300
        });
      }
                  if(infoBubble.getMap()){
          infoBubble.close();
       }
       infoBubble.open(map, marker1);
       infoBubble.addTab('Building', description1);
       infoBubble.addTab('Photo', description2);

}
    );
        }
       google.maps.event.addListener(map, "click", function () { 
       infoBubble.close();
       infoBubbleA.close();
       infoBubbleD.close();
        });
    
    InfoBubble.prototype.buildDom_ = function() {

  // ...  

  var that = this;
  google.maps.event.addDomListener(close, 'click', function() {
    that.close();
    google.maps.event.trigger(that, 'closeclick');
  });}
        
// Set blue marker indicating user position


     for (var j = 0; j < fratArray.length; j++) {
   
        var q = new google.maps.Polygon({
         paths: fratArray[j],
        strokeColor: '#CCFFEE',
        strokeOpacity: 0.2,
        strokeWeight: 2,
        fillColor: '#CCFF10',
        fillOpacity: 0.35,
        indexID: j
}
  );
        q.setMap(map);
}
        infowindowD = new google.maps.InfoWindow({
        content: ""
}
  );
        infowindowA = new google.maps.InfoWindow({
        content: ""
}
  );
  
        var request = {
        location: coords,
        radius: 500,
};

    var service = new google.maps.places.PlacesService(map);
    service.nearbySearch(request, callback);
    
    function callback(results, status) {
      if (status == google.maps.places.PlacesServiceStatus.OK) {
        for (var i = 0; i < results.length; i++) {
          var place = results[i];
          //createMarker(results[i]);
        }
      }
    }


     google.maps.event.addListenerOnce(map, "projection_changed", function(){
      map.setMapTypeId(google.maps.MapTypeId.HYBRID);  //Changes the MapTypeId in short time.
      setZoomLimit(map, google.maps.MapTypeId.ROADMAP);
      setZoomLimit(map, google.maps.MapTypeId.HYBRID);
      setZoomLimit(map, google.maps.MapTypeId.SATELLITE);
      setZoomLimit(map, google.maps.MapTypeId.TERRAIN);
      map.setMapTypeId(google.maps.MapTypeId.ROADMAP);  //Sets the MapTypeId to original.
    });


   }               // initialize end

      for (var i = 0; i < dormsArray.length; i++) {
   
        var p = new google.maps.Polygon({
        paths: dormsArray[i],
        strokeColor: '#996633',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#996633',
        fillOpacity: 0.35,
        indexID: i
}
  );
        dormPolygonArray.push(p);
} 

     for (var i = 0; i < univArray.length; i++) {
   
        var p = new google.maps.Polygon({
        paths: univArray[i],
        strokeColor: '#FF0000',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#FF0000',
        fillOpacity: 0.35,
        indexID: i
}
  );
        univPolygonArray.push(p);
}

 for (var i = 0; i < acadCoordArray.length; i++) {
   
        var p = new google.maps.Polygon({
        paths: acadCoordArray[i],
        strokeColor: '#5CADFF',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#5CADFF',
        fillOpacity: 0.35,
        indexID: i
}
  );
        acadPolygonArray.push(p);
} 



     
     function residenceBox() {
     if(box1.checked){
     for( var m=0; m < dormMarkerBox.length; m++){
     dormMarkerBox[m].setMap(map);
}
     for(var j=0; j<dormPolygonArray.length; j++){
     dormPolygonArray[j].setMap(map);
    }
}
     if(!box1.checked){
     for(var l=0; l < dormMarkerBox.length; l++){
     dormMarkerBox[l].setMap(null);

}
     for(var j=0; j<dormPolygonArray.length; j++){
     dormPolygonArray[j].setMap(null);
    }
    }}


     function academicBox() {
     if(box2.checked){
     for(m=0; m < markersArray.length; m++){
     markersArray[m].setMap(map);
}
    for(var j=0; j<univPolygonArray.length; j++){
     univPolygonArray[j].setMap(map);
    }
    }
     if(!box2.checked){
     for(l=0; l < markersArray.length; l++){
     markersArray[l].setMap(null);
}
     for(var j=0; j<univPolygonArray.length; j++){
     univPolygonArray[j].setMap(null);
    }
    }
    }


     function academicBox2() {
     if(box3.checked){
     for(i=0; i < academicMBox.length; i++){
     academicMBox[i].setMap(map);
}
    for(var j=0; j<acadPolygonArray.length; j++){
     acadPolygonArray[j].setMap(map);
    }
    }
     if(!box3.checked){
     for(i=0; i < academicMBox.length; i++){
     academicMBox[i].setMap(null);
}
     for(var j=0; j<acadPolygonArray.length; j++){
     acadPolygonArray[j].setMap(null);
    }
    }
    }
     function routeCalc(){
       if(document.getElementById('start').value != 70)
         calcRoute();
       else
         calcRoute2();
     }
  
  function setZoomLimit(map, mapTypeId){
    //Gets MapTypeRegistry
    var mapTypeRegistry = map.mapTypes;    
    //Gets the specified MapType
    var mapType = mapTypeRegistry.get(mapTypeId);
    //Sets limits to MapType
    mapType.maxZoom = 19;  
    mapType.minZoom = 14;
  }
        
        
        
            var tourLength = 8;
    for(var w=0;w<tourLength;w++){
    var walkingTourPath = new google.maps.Polyline({
    path: tourCoordsArray[w],
    geodesic: true,
    strokeColor: '#FF3030',
    strokeOpacity: 0.80,
    strokeWeight: 7
  });
        tourLineArray.push(walkingTourPath);
    }
        
    var indoorLength = 7;
    for(var wp=0;wp<indoorLength;wp++){
    var walkingTourPathIndoor = new google.maps.Polyline({
    path: tourCoordsArrayIndoor[wp],
    geodesic: true,
    strokeColor: '#5858FF',
    strokeOpacity: 0.80,
    strokeWeight: 7
  });
        tourLineArrayIndoor.push(walkingTourPathIndoor);
    }


        
        function walkingTours()
        {
for(var w=0;w<tourLineArray.length;w++)
    {
tourLineArray[w].setMap(map);
    };
for(var wp=0;wp<tourLineArrayIndoor.length;wp++){
tourLineArrayIndoor[wp].setMap(map);
}

  var tourSymbol = {
    path: google.maps.SymbolPath.FORWARD_CLOSED_ARROW,
    scale: 8,
    strokeColor: '#393'
  };
  tourLine = new google.maps.Polyline({
    path: animationCourse,
    icons: [{
      icon: tourSymbol,
      offset: '100%',
      repeat: '400px'
    }],
    map: map
  });

  animateCircle();
            
function animateCircle() {
    var count = 0;
    window.setInterval(function() {
      count = (count + 1) % 200;

      var icons = tourLine.get('icons');
      icons[0].offset = (count / 2) + '%';
      tourLine.set('icons', icons);
  }, 100);
}
        }
        
            function locate(){
            if  (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(setMarker);
          } else {
            alert("Your browser does not support the Geolocation API");
}
        // Set blue marker indicating user position
function setMarker(pos) {
        var lat = pos.coords.latitude,
        lng = pos.coords.longitude;
        coords = new google.maps.LatLng(lat, lng);
        posMarker = new google.maps.Marker({
        map: map,
        icon: 'markers/TrackingDot.png',
        position: coords,
        animation: google.maps.Animation.DROP,
        title: "Current Position"
}
  );
        map.panTo(coords);
            directionsDisplay = new google.maps.DirectionsRenderer();
          // Update user's location  
          positionTimer = navigator.geolocation.watchPosition(function (pos) {
           var lat = pos.coords.latitude,
           lng = pos.coords.longitude;
           coords = new google.maps.LatLng(lat, lng);
            posMarker.setPosition(coords);
}
      
  );
        directionsDisplay.setMap(map);
        currentLocationArray.push(posMarker);
     }
        
    }
        
    google.maps.event.addDomListener(window, 'load', initialize);
  </script>
  </head>
  
<body>
    
    
<!--17 closing divs            -->
<div id="divContainer" class="container"></div>
<div class="container">
<div class="row">
<div class="column">
<div class="col-xs-12 col-md-12 col-lg-12 col-xl-12" style="background-color: #3D007A;
                                                            height: 60px;" >
<div id="sewaneeBox" class="topBox">
<img src="SewaneeLogo.png" class="Logos">
<hr>		
</div>
</div>				
</div>				
</div>
<div class="row">
<div class="col-xs-12 col-md-12 col-lg-12 col-xl-12">
<div id="map-canvas">
</div>
</div>
<div class="row">
<div class="col-xs-1 col-md-1 col-lg-1 col-xl-1">
</div>
<div class="col-xs-11 col-md-11 col-lg-11 col-xl-11">
<br>
 <b>Directions From</b>
    <select id="start" onchange="routeCalc();">
      <option value="none">                                        Choose Origin</option>
      <option value="nothing">                                   - - - - - - - - - - - - - - -</option>
      <option value="70">                                        Current Location</option>
      <option value="4">                                         Gailor Hall</option>
      <option value="3">                                         Hospital</option>
      <option value="0">                                         Walsh-Ellett Hall</option>
      <option value="1">                                         Book Store</option>
      <option value="2">                                         Woods/Spencer Hall</option>
      <option value="5">                                         McClurg Dining Hall</option>
      <option value="6">                                         Fowler Center</option>
      <option value="7">                                         Carnegie Hall</option>
      <option value="8">                                         DuPoint Library</option>
      <option value="9">                                         Bishops Commons</option>
      <option value="10">                                        Fulford Hall</option>
      <option value="11">                                        All Saints</option>
      <option value="12">                                        Thompson Union</option>
      <option value="13">                                        St. Lukes Hall</option>
      <option value="14">                                        McCrady Hall</option>
      <option value="15">                                        Van Ness Hall</option>
      <option value="16">                                        Snowden Hall</option>
      <option value="17">                                        Archives</option>
      <option value="18">                                        Police/Fire Service</option>
      <option value="19">                                        Stirlings</option>
      <option value="20">                                        McGriff Alumni House</option>
      <option value="21">                                        Hoffman Hall</option>
      <option value="22">                                        Career Services</option>
      <option value="23">                                        Barnwick Womens Center</option>
      <option value="24">                                        EQB</option>
      <option value="25">                                        Chen Hall</option>
      <option value="26">                                        Convocation Hall</option>
      <option value="27">                                        Guerry Hall and Art Gallery</option>
      <option value="28">                                        Soccer Field</option>
      <option value="29">                                        Golf Course</option>
      <option value="30">                                        Equestrian</option>
      <option value="31">                                        Tennis Courts</option>
      <option value="32">                                        Football Field</option>
      <option value="33">                                        Baseball Field</option>
      <option value="34">                                        Memorial Cross</option>
      <option value="35">                                        Morgan's Steep</option>
      <option value="36">                                        Green's View</option>
      <option value="37">                                        Sewanee Inn</option>
      <option value="38">                                        St. Lukes Chapel</option>
      <option value="39">                                        Spencer</option>
      <option value="40">                                        Tennesee Williams Center</option>
      <option value="41">                                        Cravens Hall</option>
      <option value="42">                                        University Farm</option>
      <option value="43">                                        Nabit Art Building</option>
      <option value="44">                                        MultiCultural Center</option>
      <option value="45">                                        Hodgeson</option>
      <option value="46">                                        Philips</option>
      <option value="47">                                        Smith</option>
      <option value="48">                                        Trez</option>
      <option value="49">                                        Courts</option>
                </select>  
   <br>
   <br>
<b>Directions To&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</b>
    <select id="end" onchange="routeCalc();">
      <option value="none">                                        Choose Destination</option>
      <option value="nothing">                                   - - - - - - - - - - - - - - -</option>
      <option value="4">                                         Gailor Hall</option>
      <option value="3">                                         Hospital</option>
      <option value="0">                                         Walsh-Ellett Hall</option>
      <option value="1">                                         Book Store</option>
      <option value="2">                                         Woods/Spencer Hall</option>
      <option value="5">                                         McClurg Dining Hall</option>
      <option value="6">                                         Fowler Center</option>
      <option value="7">                                         Carnegie Hall</option>
      <option value="8">                                         DuPoint Library</option>
      <option value="9">                                         Bishops Commons</option>
      <option value="10">                                        Fulford Hall</option>
      <option value="11">                                        All Saints</option>
      <option value="12">                                        Thompson Union</option>
      <option value="13">                                        St. Lukes Hall</option>
      <option value="14">                                        McCrady Hall</option>
      <option value="15">                                        Van Ness Hall</option>
      <option value="16">                                        Snowden Hall</option>
      <option value="17">                                        Archives</option>
      <option value="18">                                        Police/Fire Service</option>
      <option value="19">                                        Stirlings</option>
      <option value="20">                                        McGriff Alumni House</option>
      <option value="21">                                        Hoffman Hall</option>
      <option value="22">                                        Career Services</option>
      <option value="23">                                        Barnwick Womens Center</option>
      <option value="24">                                        EQB</option>
      <option value="25">                                        Chen Hall</option>
      <option value="26">                                        Convocation Hall</option>
      <option value="27">                                        Guerry Hall and Art Gallery</option>
      <option value="28">                                        Soccer Field</option>
      <option value="29">                                        Golf Course</option>
      <option value="30">                                        Equestrian</option>
      <option value="31">                                        Tennis Courts</option>
      <option value="32">                                        Football Field</option>
      <option value="33">                                        Baseball Field</option>
      <option value="34">                                        Memorial Cross</option>
      <option value="35">                                        Morgan's Steep</option>
      <option value="36">                                        Green's View</option>
      <option value="37">                                        Sewanee Inn</option>
      <option value="38">                                        St. Lukes Chapel</option>
      <option value="39">                                        Spencer</option>
      <option value="40">                                        Tennesee Williams Center</option>
      <option value="41">                                        Cravens Hall</option>
      <option value="42">                                        University Farm</option>
      <option value="43">                                        Nabit Art Building</option>
      <option value="44">                                        MultiCultural Center</option>
      <option value="45">                                        Hodgeson</option>
      <option value="46">                                        Philips</option>
      <option value="47">                                        Smith</option>
      <option value="48">                                        Trez</option>
      <option value="49">                                        Courts</option>
    </select>
</div>
</div>
<div class="row">
<div class ="col-xs-1 col-md-1 col-lg-1 col-xl-1">
</div>
<div class ="col-xs-11 col-md-11 col-lg-11 col-xl-11">
<input type="checkbox" id="box1" onchange="residenceBox()"/>Residence Halls<br>
<input type="checkbox" id="box2" onchange="academicBox()"/>University Buildings<br>
<input type="checkbox" id="box3" onchange="academicBox2()"/>Acadmic Buildings</br>
</div></div>
</div>
</div>
</div>
</div>
</div>
    </body>
  </html>
